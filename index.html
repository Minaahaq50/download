<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</title>
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      margin: 0;
      padding: 0;
      color: #fff;
    }
    header {
      background: #1e1e1e;
      padding: 20px;
      text-align: center;
      font-size: 22px;
      font-weight: bold;
      color: #ffcc00;
      box-shadow: 0 4px 12px rgba(0,0,0,0.6);
      letter-spacing: 1px;
    }
    .container {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
      padding: 25px;
    }
    .card {
      background: rgba(30,30,30,0.95);
      padding: 25px;
      border-radius: 14px;
      text-align: center;
      box-shadow: 0 6px 15px rgba(0,0,0,0.6);
      border: 1px solid #333;
      transition: transform 0.3s;
    }
    .card:hover { transform: scale(1.02); }
    .card h2 { margin: 0 0 15px; color: #4CAF50; font-size: 20px; }
    input, select, button {
      width: 100%; padding: 14px; margin: 10px 0;
      border-radius: 8px; border: none; font-size: 15px;
    }
    input, select {
      background: #2a2a2a; color: white; border: 1px solid #444;
    }
    input:focus, select:focus {
      outline: none; border-color: #ffcc00; box-shadow: 0 0 8px #ffcc00;
    }
    button {
      background: linear-gradient(90deg, #ffcc00, #ff9900);
      color: #1e1e1e; font-weight: bold; cursor: pointer; transition: 0.3s;
    }
    button:hover { background: linear-gradient(90deg, #ffdb4d, #ffaa33); }
    .hidden { display: none; }
    .message {
      margin-top: 12px; padding: 12px; border-radius: 8px;
      font-weight: bold; font-size: 15px; text-align: center;
    }
    .success { background: #2e7d32; border: 1px solid #1b5e20; }
    .error   { background: #d32f2f; border: 1px solid #9a0007; }
    .warning { background: #fbc02d; color: #000; border: 1px solid #c17900; }
    .loading { background: #0288d1; border: 1px solid #01579b; }

    /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    #loadingOverlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.95); display: none;
      align-items: center; justify-content: center;
      font-size: 22px; color: #ffcc00; z-index: 999;
      flex-direction: column; font-weight: bold; letter-spacing: 1px;
    }
    #loadingOverlay.active { display: flex; }
    .spinner {
      border: 6px solid #444; border-top: 6px solid #ffcc00;
      border-radius: 50%; width: 50px; height: 50px;
      animation: spin 1s linear infinite; margin-bottom: 15px;
    }
    @keyframes spin { 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>

<header>ğŸ“Œ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ - Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø£Ù…ÙŠØ± ØªØ§Ø¯Ø±Ø³</header>

<div class="container">

  <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ -->
  <div class="card">
    <h2>ğŸ‘¤ ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
    <p style="color:#bbb; font-size:15px; margin-bottom:15px;">
      Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø¯Ù‚Ø© Ù„ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
    </p>

    <label for="studentName" style="display:block; text-align:right; margin:5px 0;">âœï¸ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label>
    <input type="text" id="studentName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">

    <label for="studentClass" style="display:block; text-align:right; margin:5px 0;">ğŸ“ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
    <select id="studentClass">
      <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø³Ù†Ø© --</option>
      <option value="Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ">Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
      <option value="Ø«Ø§Ù†ÙˆÙŠ">Ø«Ø§Ù†ÙˆÙŠ</option>
      <option value="Ø¬Ø§Ù…Ø¹Ø©">Ø¬Ø§Ù…Ø¹Ø©</option>
    </select>

    <label for="studentPhone" style="display:block; text-align:right; margin:5px 0;">ğŸ“± Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„</label>
    <input type="tel" id="studentPhone" placeholder="11 Ø±Ù‚Ù… ÙÙ‚Ø·" maxlength="11">

    <button onclick="saveStudent()" style="margin-top:15px; font-size:17px; font-weight:bold;">
      ğŸ’¾ Ø­ÙØ¸ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨
    </button>

    <p id="studentInfo" class="message warning" style="margin-top:15px;">
      âš ï¸ Ù„Ù… ØªÙ‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø¹Ø¯
    </p>
  </div>

  <!-- Ø§Ù„Ø­Ø¶ÙˆØ± -->
  <div class="card hidden" id="attendanceSection">
    <h2>â° Ø§Ù„Ø­Ø¶ÙˆØ±</h2>
    <button onclick="sendAttendance()">âœ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±ÙŠ</button>
    <p id="attendanceStatus" class="message warning">âš ï¸ Ù„Ù… ØªØ³Ø¬Ù„ Ø­Ø¶ÙˆØ±Ùƒ Ø¨Ø¹Ø¯</p>
  </div>

  <!-- Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª -->
  <div class="card hidden" id="examSection">
    <h2>ğŸ“ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</h2>
    <div id="examList" class="message loading">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  </div>

</div>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù„ÙˆØ¯Ù†Ø¬ -->
<div id="loadingOverlay">
  <div class="spinner"></div>
  â³ Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // âœ… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyDqkS7udZdgZqKWkw2Wvdx0aWbjU8EfCg8",
    authDomain: "drosk-622f6.firebaseapp.com",
    databaseURL: "https://drosk-622f6-default-rtdb.firebaseio.com",
    projectId: "drosk-622f6",
    storageBucket: "drosk-622f6.firebasestorage.app",
    messagingSenderId: "765071631440",
    appId: "1:765071631440:web:a2305e478babc4534add55",
    measurementId: "G-2SL3D7TCQE"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let studentData = {};

  // âœ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
  function saveStudent(){
    const name = document.getElementById("studentName").value.trim();
    const studentClass = document.getElementById("studentClass").value;
    const phone = document.getElementById("studentPhone").value.trim();

    if(!name || !studentClass || !phone){
      showMessage("studentInfo","âŒ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","error");
      return;
    }
    if(!/^[0-9]{11}$/.test(phone)){
      showMessage("studentInfo","âŒ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 11 Ø±Ù‚Ù… ÙÙ‚Ø·","error");
      return;
    }

    // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
    document.getElementById("loadingOverlay").classList.add("active");

    setTimeout(()=>{
      studentData = {name, class:studentClass, phone};

      db.ref("students/" + phone).set({
        name: name,
        class: studentClass,
        phone: phone,
        timestamp: new Date().toISOString()
      }).then(()=>{
        showMessage("studentInfo",`âœ… ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ: ${name} - ${studentClass} - ${phone}`,"success");
        document.getElementById("attendanceSection").classList.remove("hidden");
        document.getElementById("examSection").classList.remove("hidden");
        loadExams();
        document.getElementById("loadingOverlay").classList.remove("active");
      }).catch((err)=>{
        showMessage("studentInfo","âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸: "+err.message,"error");
        document.getElementById("loadingOverlay").classList.remove("active");
      });
    },2000);
  }

  // âœ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±
  function sendAttendance(){
    if(!studentData.name){
      showMessage("attendanceStatus","âŒ Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹","error");
      return;
    }
    const today = new Date().toISOString().split("T")[0];
    db.ref("attendance/" + studentData.phone + "/" + today).set({
      name: studentData.name,
      class: studentData.class,
      phone: studentData.phone,
      date: today,
      time: new Date().toLocaleTimeString()
    }).then(()=>{
      showMessage("attendanceStatus","âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±Ùƒ Ø¨Ù†Ø¬Ø§Ø­","success");
    }).catch((err)=>{
      showMessage("attendanceStatus","âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±: "+err.message,"error");
    });
  }

  // âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª (ØªØ¬Ø±ÙŠØ¨ÙŠ)
  function loadExams(){
    const exams = [
      {name:"Ø§Ù…ØªØ­Ø§Ù† Ù„Ø­Ø§Ù†", link:"#"},
      {name:"Ø§Ù…ØªØ­Ø§Ù† Ù‚Ø¨Ø·ÙŠ", link:"#"},
      {name:"Ø§Ù…ØªØ­Ø§Ù† Ø·Ù‚Ø³", link:"#"}
    ];
    let html = "";
    exams.forEach(e=>{
      html += `<div class="message success">ğŸ“˜ ${e.name} <br><a href="${e.link}" style="color:#fff; text-decoration:underline;">ğŸš€ Ø¯Ø®ÙˆÙ„</a></div>`;
    });
    document.getElementById("examList").innerHTML = html;
  }

  // âœ… Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©
  function showMessage(id,text,type){
    const el = document.getElementById(id);
    el.innerText = text;
    el.className = "message "+type;
    el.classList.remove("hidden");
  }
</script>

</body>
  </html>
